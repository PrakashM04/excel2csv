<!DOCTYPE html>
<html>
<head>
  <title>Excel to CSV Converter</title>
  <meta name="description" content="Export Excel workbook sheets to different csv files at once">
  <style>
    * {
        margin: 0; padding: 0;
        box-sizing: border-box;

    }
    a {color: rgb(7, 238, 238);}
    body {
        display: flex;
        flex-direction: column;
      font-family: Arial, sans-serif;
      height: 100vh;
      /* margin: 20px; */
      background-color: #00333a;
      color: #d8d8d8;
    }

    
    .nav-container {
        width: 100%;
        height: auto;
        background-color: #fff !important;
    }
    
    .navbar {
        width: 90%;
        margin: auto;
        padding: 20px;
        color: #05c5ff;
        background-color: transparent;
        
    }


    .logo {
      font-size: 24px;
      font-weight: bold;
    }

    .container {
      margin: 30px auto ;
      text-align: center;

    }

    h1 {
        margin-bottom: 20px !important;
    }

    #drop-area {
      position: relative;
      width: 350px;
      height: 150px;
      border: 2px dashed #ccc;
      text-align: center;
      font-size: 20px;
      color: #888;
      margin: 20px auto;
      cursor: pointer;
    }

    #drop-area.dragged {
      background-color: #f0f0f0;
    }

    #file-input {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      opacity: 0;
      cursor: pointer;
    }

    #drop-area-label {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
    }

    #file-name {
      margin: 30px auto;;
      font-weight: bold;
      margin: auto;
      color: #d6d32a;
    }

    #output {
      margin-top: 20px;
    }

    #output p {
      margin-bottom: 10px;
      
    }

    #save-btn {
      display: block;
      padding: 10px 20px;
      margin: 30px auto;
      font-size: 16px;
      background: #049dd4;
      color:#f0f0f0;
    }

    /* Chat Section Styles */
    .chat-container {
      margin: 80px auto;
      border: 2px solid #136c83;
      padding: 20px;
      width: 360px;
      background-color: #02515f;
    }

    .user-message {
      background-color: #034a6b;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
      color: #aaa9a9;
    }

    .assistant-message {
      background-color: #02726c;
      padding: 10px;
      margin-bottom: 10px;
      border-radius: 5px;
    }

    footer {
        margin-top: auto;
        padding: 15px;
        background: #00423f;
        color: #999999;
    }
    footer .footer-container {
        width: 90%;
        margin: auto;
        text-align: center;
    }
    footer .footer-container span {
        color: #008fbb;
        font-style: italic;
    }
  </style>
</head>
<body>
    <div class="nav-container">
    <nav class="navbar">
        <!-- <div class="logo">Pibit.ai</div> -->
        <img src="PIBIT_LOGO.png" alt="Pibit.ai" width= "100px;">
    </nav>
    </div>

  <div class="container">
    <h1> Excel Sheets to CSV Convertor</h1>
    <div id="drop-area" ondragover="event.preventDefault()" ondrop="handleDrop(event)" ondragenter="this.classList.add('dragged')" ondragleave="this.classList.remove('dragged')">
      <label id="drop-area-label" for="file-input">Drag and drop an Excel file here or click to browse</label>
      <input type="file" id="file-input" accept=".xls,.xlsx" onchange="handleFileChange(event)">
    </div>

    <div id="file-name"></div>

    <button id="save-btn" onclick="saveSheets()" disabled>Convert Sheets to CSV</button>

    <div class="output_list">
        <h3>Download CSV files:</h3>
    </div>

    <div id="output">
        
    </div>
  </div>

  <div class="chat-container">
    <div class="user-message">
      User: Hello, I have an Excel file to convert.
    </div>

    <div class="assistant-message">
      Assistant: Sure, please drag and drop the Excel file here or click to browse.
    </div>

    <!-- More chat messages can be added dynamically using JavaScript -->

  </div>

  <footer>
    <div class="footer-container">
        <p>2023 | Created by <span>Prakash Kumar </span></p>
    </div>
  </footer>

  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    let fileData = null;
    let fileName = null;

    function handleFileChange(event) {
      const file = event.target.files[0];
      if (file) {
        readFile(file);
        fileName = file.name;
        updateFileName();
      } else {
        fileData = null;
        fileName = null;
        updateFileName();
      }
    }

    function handleDrop(event) {
      event.preventDefault();
      const file = event.dataTransfer.files[0];
      if (file) {
        readFile(file);
        fileName = file.name;
        updateFileName();
      } else {
        fileData = null;
        fileName = null;
        updateFileName();
      }
    }

    function openFileBrowser() {
      document.getElementById('file-input').click();
    }

    function readFile(file) {
      const reader = new FileReader();
      reader.onload = function (e) {
        fileData = e.target.result;
        document.getElementById('save-btn').style.display = 'block';
      };
      reader.readAsBinaryString(file);
    }

    function saveSheets() {
      const workbook = XLSX.read(fileData, { type: 'binary' });
      const sheetNames = workbook.SheetNames;

      const outputDiv = document.getElementById('output');
      outputDiv.innerHTML = '';

      sheetNames.forEach(function (sheetName) {
        const sheetData = XLSX.utils.sheet_to_csv(workbook.Sheets[sheetName]);
        const blob = new Blob([sheetData], { type: 'text/csv;charset=utf-8' });
        const csvFileName = sheetName + '.csv';

        const downloadLink = document.createElement('a');
        downloadLink.href = URL.createObjectURL(blob);
        downloadLink.download = csvFileName;
        downloadLink.innerText = csvFileName;

        const p = document.createElement('p');
        p.appendChild(downloadLink);
        outputDiv.appendChild(p);
      });
    }

    function updateFileName() {
      const fileNameDiv = document.getElementById('file-name');
      const saveBtn = document.getElementById('save-btn');

      if (fileName) {
        fileNameDiv.innerText = 'File Name: ' + fileName;
        fileNameDiv.style.display = 'block';
        saveBtn.disabled = false;
        saveBtn.style.display = 'block';
      } else {
        fileNameDiv.innerText = '';
        fileNameDiv.style.display = 'none';
        saveBtn.disabled = true;
        saveBtn.style.display = 'none';
      }
    }
  </script>
</body>
</html>
